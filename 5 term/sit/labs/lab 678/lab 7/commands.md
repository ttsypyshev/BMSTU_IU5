Для выполнения лабораторной работы с использованием утилиты `tcpdump` для перехвата различных типов сетевого трафика, вам нужно будет использовать конкретные фильтры и опции для каждого задания. Я предоставлю вам пошаговое руководство, как выполнить каждое из заданий.

### 1. Запуск `tcpdump` для захвата всех пакетов, проходящих по сети
Чтобы захватывать все пакеты в сети без фильтрации, используйте команду:

```bash
sudo tcpdump -c 7
```

- `-c 7` — ограничивает количество захватываемых пакетов до 7.


```bash
tcpdump: verbose output suppressed, use -v[v]... for full protocol decode
listening on wlo1, link-type EN10MB (Ethernet), snapshot length 262144 bytes
03:21:29.351614 IP ttsypyshev-Modern-14-B11MOU.43978 > lh-in-f95.1e100.net.https: Flags [P.], seq 2805534563:2805534602, ack 1157091356, win 407, options [nop,nop,TS val 2053612174 ecr 584189844], length 39
03:21:29.351840 IP ttsypyshev-Modern-14-B11MOU.43978 > lh-in-f95.1e100.net.https: Flags [FP.], seq 39:63, ack 1, win 407, options [nop,nop,TS val 2053612174 ecr 584189844], length 24
03:21:29.450004 IP ttsypyshev-Modern-14-B11MOU.57814 > _gateway.domain: 14905+ PTR? 95.161.233.64.in-addr.arpa. (44)
03:21:29.632502 IP _gateway.domain > ttsypyshev-Modern-14-B11MOU.57814: 14905 1/0/0 PTR lh-in-f95.1e100.net. (77)
03:21:29.633522 IP ttsypyshev-Modern-14-B11MOU.33525 > _gateway.domain: 28769+ PTR? 189.43.168.192.in-addr.arpa. (45)
03:21:29.636289 IP _gateway.domain > ttsypyshev-Modern-14-B11MOU.33525: 28769 NXDomain 0/0/0 (45)
03:21:29.637635 IP ttsypyshev-Modern-14-B11MOU.41285 > _gateway.domain: 571+ PTR? 108.43.168.192.in-addr.arpa. (45)
7 packets captured
8 packets received by filter
0 packets dropped by kernel
```

### 2. Запуск `tcpdump` для перехвата широковещательного трафика
Для фильтрации широковещательного трафика по MAC-адресу `FF:FF:FF:FF:FF:FF` и IP-адресу, который можно узнать с помощью `ifconfig`, используйте следующую команду:

```bash
sudo tcpdump -c 5 ether broadcast and ip broadcast and host <IP-адрес> -X
```

- `-c 5` — ограничение захвата до 5 пакетов.
- `ether broadcast` — фильтрует по широковещательному MAC-адресу.
- `ip broadcast` — фильтрует по широковещательному IP-адресу.
- `-X` — выводит пакет в шестнадцатеричной и ASCII форме.

### 3. Запуск `tcpdump` для перехвата пакетов ICMP
Чтобы перехватывать пакеты ICMP, отправленные на IP-адрес одного из лабораторных ПК, используйте:

```bash
sudo tcpdump -c 8 icmp and host <IP-адрес лабораторного ПК> -XX
```

- `icmp` — фильтрует только ICMP-пакеты.
- `-XX` — выводит пакеты в шестнадцатеричной и ASCII форме.

Используйте `ping`, чтобы сгенерировать ICMP-запросы на лабораторный ПК.

### 4. Перехват трафика утилиты `traceroute`
Для перехвата трафика, генерируемого утилитой `traceroute`, сначала получите IP-адрес узла с помощью утилиты `nslookup`:

```bash
nslookup <domain_name>
```

Затем используйте команду `tcpdump` для перехвата трафика `traceroute`:

```bash
sudo tcpdump -c 7 udp and host <IP-адрес узла> -X
```

- `udp` — фильтрует трафик UDP, который используется утилитой `traceroute`.

### 5. Перехват пакетов TCP с флагом SYN
Для отбора TCP-сегментов с флагом SYN, используйте команду:

```bash
sudo tcpdump -c 2 -lvnnSXX 'tcp[tcpflags] & tcp-syn != 0'
```

- `-c 2` — захватить только два пакета.
- `'tcp[tcpflags] & tcp-syn != 0'` — фильтрует пакеты, где установлен флаг SYN.
- `-S` — отображает реальные номера последовательности.
- `-X` — выводит данные пакета в шестнадцатеричной и ASCII формах.

### 6. Отбор дейтаграмм UDP между ПК и сервером на портах DNS и диапазоне 10000–65535
Для фильтрации UDP-пакетов между локальным ПК и сервером, отправленных с порта DNS (порт 53), на диапазон портов назначения 10000–65535:

```bash
sudo tcpdump -c 10 udp and src port 53 and dst portrange 10000-65535
```

- `src port 53` — фильтрует по исходному порту DNS.
- `dst portrange 10000-65535` — фильтрует по диапазону портов назначения.

### 7. Отбор дейтаграмм TCP с исходным портом менее 1024
Для отбора TCP-пакетов, исходящие порты которых меньше 1024, используйте:

```bash
sudo tcpdump -c 2 tcp and src port <1024>
```

- `src port <1024` — фильтрует по исходным портам менее 1024.

### 8. Отбор дейтаграмм с портами назначения больше 1024
Для отбора пакетов с номерами портов назначения, превышающими 1024, используйте:

```bash
sudo tcpdump -c 2 'tcp or udp' and dst port > 1024
```

- `dst port > 1024` — фильтрует по портам назначения, большими 1024.

### 9. Отбор UDP-пакетов с размером от 50 до 100 байт
Чтобы отобрать UDP-пакеты, размер которых больше 50 байт, но не превышает 100 байт:

```bash
sudo tcpdump -c 10 udp and greater 50 and less 100
```

- `greater 50` — фильтрует пакеты больше 50 байт.
- `less 100` — фильтрует пакеты меньше 100 байт.

### 10. Отбор IP-пакетов TCP с исходным портом менее 1024 и портом назначения более 10000, размером до 100 байт
Для отбора таких пакетов:

```bash
sudo tcpdump -c 2 'ip and tcp and src port <1024 and dst port >10000 and less 100'
```

- `src port <1024` — фильтрует по исходному порту меньше 1024.
- `dst port >10000` — фильтрует по порту назначения больше 10000.
- `less 100` — фильтрует по размеру пакетов меньше 100 байт.

---

### Важные замечания:
- Убедитесь, что у вас есть права администратора для выполнения команд `tcpdump`. Используйте `sudo` для запуска команд с нужными привилегиями.
- Все результаты команд нужно сохранять в отчет, например, с использованием оператора `tee` для записи выводов в файлы:

```bash
sudo tcpdump -c 7 | tee tcpdump_output.txt
```

- Для выполнения лабораторной работы убедитесь, что у вас есть доступ к необходимым узлам и серверу для проверки разных типов трафика.
