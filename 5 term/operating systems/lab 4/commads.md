# ОС Ubuntu. Расширенные права доступа  к файлам и каталогам

## Создание каталога с общим доступом(shared)

### Создание учетных записей пользователей

Cозданиt пользователей с помощью утилиты `adduser`:

```bash
sudo adduser dekan
sudo adduser sotrudnik
sudo adduser admin_dek
```

При создании каждого пользователя будет предложено ввести пароль. Установите пароль `dekanat` для всех пользователей, но будет `dek4nat!`

### Создание группы и добавление пользователей в группу

1. Создайте группу `group_dek`:

   ```bash
   sudo groupadd group_dek
   ```

2. Добавьте пользователей в группу `group_dek` и группу `sudo`:

   ```bash
   sudo usermod -aG group_dek dekan
   sudo usermod -aG group_dek sotrudnik
   sudo usermod -aG group_dek admin_dek

   sudo usermod -aG sudo dekan
   sudo usermod -aG sudo sotrudnik
   sudo usermod -aG sudo admin_dek
   ```

### Создание каталога ДЕКАНАТ

1. Создайте каталог `ДЕКАНАТ` в корневом каталоге:

   ```bash
   sudo mkdir /ДЕКАНАТ
   ```

2. Установите группу владельцев каталога на `group_dek`:

   ```bash
   sudo chown admin_dek:group_dek /ДЕКАНАТ
   ```

### Изменение владельца и группы каталога

Убедитесь, что владелец каталога `ДЕКАНАТ` — `admin_dek`:

```bash
ls -ld /ДЕКАНАТ
```

Вывод должен показывать `admin_dek` как владельца и `group_dek` как группу.

### Установка прав доступа

1. Установите права доступа для каталога, чтобы члены группы могли создавать файлы:

   ```bash
   sudo chmod 2770 /ДЕКАНАТ
   ```

   Здесь `2` устанавливает бит SGID, который позволяет всем файлам, создаваемым в каталоге, наследовать группу `group_dek`.

2. Убедитесь, что все файлы, созданные в каталоге, будут принадлежать группе `group_dek`:

   ```bash
   sudo chmod g+s /ДЕКАНАТ
   ```

3. Чтобы пользователи могли удалять только свои файлы, нужно установить права так, чтобы разрешать удаление файлов только их владельцам. В данном случае стандартные права `rwx` для пользователя, группы и `--x` для других подходят.

### Создание подкаталогов

1. Создайте каталоги `ПРИКАЗЫ` и `ИНФОРМАЦИЯ` внутри `ДЕКАНАТ`:

   ```bash
   sudo mkdir /ДЕКАНАТ/ПРИКАЗЫ
   sudo mkdir /ДЕКАНАТ/ИНФОРМАЦИЯ
   ```

2. Установите для них права:

   ```bash
   sudo chown admin_dek:group_dek /ДЕКАНАТ/ПРИКАЗЫ
   sudo chown admin_dek:group_dek /ДЕКАНАТ/ИНФОРМАЦИЯ

   sudo chmod 2770 /ДЕКАНАТ/ПРИКАЗЫ
   sudo chmod 2770 /ДЕКАНАТ/ИНФОРМАЦИЯ
   ```

### Проверка корректности созданных каталогов

Проверьте права доступа к каталогам:

```bash
ls -l /ДЕКАНАТ
```

### Вход с учетными записями и создание файлов

1. Создайте файл `Приказ061121.txt` в каталоге `/ДЕКАНАТ/ПРИКАЗЫ`:

   ```bash
   touch /ДЕКАНАТ/ПРИКАЗЫ/Приказ061121.txt
   ```

2. Для пользователя `sotrudnik` создайте файл `Новости.txt` в каталоге `/ДЕКАНАТ/ИНФОРМАЦИЯ`:

   ```bash
   touch /ДЕКАНАТ/ИНФОРМАЦИЯ/Новости.txt
   ```

### Проверка прав доступа к созданным файлам

Проверьте права доступа к созданным файлам:

```bash
ls -l /ДЕКАНАТ/ПРИКАЗЫ/Приказ061121.txt
ls -l /ДЕКАНАТ/ИНФОРМАЦИЯ/Новости.txt
```

Убедитесь, что файлы принадлежат соответствующим пользователям и группе `group_dek`. 

## Управление расширенными правами доступа к файлам и каталогам с использованием ACL

### Проверка текущих прав доступа к каталогу ПРИКАЗЫ

В терминале выполните команду `getfacl`, чтобы проверить текущие права доступа к каталогу `ПРИКАЗЫ`:

```bash
getfacl /ДЕКАНАТ/ПРИКАЗЫ
```

Это покажет текущие права доступа, включая стандартные права и любые ACL, которые могут быть установлены.

### Установка прав доступа для пользователей dekan и sotrudnik

Установите права доступа для пользователя `dekan` (полный доступ) и `sotrudnik` (только чтение) к каталогу `ПРИКАЗЫ` с помощью команды `setfacl`:

```bash
sudo setfacl -m u:dekan:rwx /ДЕКАНАТ/ПРИКАЗЫ  # Полный доступ для dekan
sudo setfacl -m u:sotrudnik:r /ДЕКАНАТ/ПРИКАЗЫ  # Только чтение для sotrudnik
```

### Проверка текущих прав доступа к каталогу ПРИКАЗЫ

Снова выполните команду `getfacl`, чтобы убедиться, что права были установлены корректно:

```bash
getfacl /ДЕКАНАТ/ПРИКАЗЫ
```

Убедитесь, что в выводе присутствуют записи для пользователей `dekan` и `sotrudnik` с правильными правами доступа.

### Проверка текущих прав доступа к каталогу ИНФОРМАЦИЯ

Выполните команду `getfacl`, чтобы проверить текущие права доступа к каталогу `ИНФОРМАЦИЯ`:

```bash
getfacl /ДЕКАНАТ/ИНФОРМАЦИЯ
```

### Установка прав доступа для пользователей sotrudnik и dekan к каталогу ИНФОРМАЦИЯ

Установите права доступа для пользователя `sotrudnik` (полный доступ) и `dekan` (только чтение) к каталогу `ИНФОРМАЦИЯ`:

```bash
sudo setfacl -m u:sotrudnik:rwx /ДЕКАНАТ/ИНФОРМАЦИЯ  # Полный доступ для sotrudnik
sudo setfacl -m u:dekan:r /ДЕКАНАТ/ИНФОРМАЦИЯ       # Только чтение для dekan
```

### Проверка текущих прав доступа к каталогу ИНФОРМАЦИЯ

Выполните команду `getfacl`, чтобы убедиться, что права были установлены корректно:

```bash
getfacl /ДЕКАНАТ/ИНФОРМАЦИЯ
```